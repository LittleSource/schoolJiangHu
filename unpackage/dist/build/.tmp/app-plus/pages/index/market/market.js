(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/market/market"],{"0dbc":function(t,e,a){"use strict";var i=a("d83c"),n=a.n(i);n.a},"15c9":function(t,e,a){"use strict";var i=a("f66e"),n=a.n(i);n.a},"1c0b":function(t,e,a){},"48a3":function(t,e,a){"use strict";var i=a("e15a"),n=a.n(i);n.a},"49a8":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"graceNumberBox",props:{disabled:{type:Boolean,default:!1},value:{type:Number,default:0},index:{type:Number,default:0},maxNum:{type:Number,default:20},minNum:{type:Number,default:1}},data:function(){return{inputNumber:this.value}},watch:{value:function(t){this.inputNumber=t},inputNumber:function(t){t>this.maxNum&&(t=this.maxNum,this.inputNumber=t),t<this.minNum&&(t=this.minNum,this.inputNumber=t,console.log(11)),this.$emit("change",[t,this.index])}},methods:{add:function(){var t=this.inputNumber+1;this.inputNumber=Number(t)},reduce:function(){var t=this.inputNumber-1;this.inputNumber=t},blur:function(t){this.inputNumber=Number(t.detail.value)}}};e.default=i},"4cf4":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{directives:[{name:"show",rawName:"v-show",value:t.ifshow,expression:"ifshow"}],staticClass:"popup-layer",attrs:{eventid:"36ed7ea2-1"},on:{tap:t.close}},[a("view",{ref:"popRef",staticClass:"popup-content",style:t._location,attrs:{eventid:"36ed7ea2-0"},on:{tap:function(e){e.stopPropagation(),t.stopEvent(e)}}},[t._t("default",null,{mpcomid:"36ed7ea2-0"})],2)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},5249:function(t,e,a){"use strict";a.r(e);var i=a("4cf4"),n=a("628c");for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a("0dbc");var s=a("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},5260:function(t,e,a){"use strict";a.r(e);var i=a("65a6"),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e["default"]=n.a},"56a3":function(t,e,a){"use strict";a.r(e);var i=a("e819"),n=a("5260");for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a("15c9");var s=a("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},"628c":function(t,e,a){"use strict";a.r(e);var i=a("c52d"),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e["default"]=n.a},"65a6":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"graceSpeaker",props:{msgs:{type:Array,default:function(){return[]}},icon:{type:String,default:""},interval:{type:Number,default:3e3},vertical:{type:Boolean,default:!0}}};e.default=i},"6a77":function(t,e,a){"use strict";var i=a("1c0b"),n=a.n(i);n.a},"81c5":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticStyle:{height:"100%"}},[a("graceSpeaker",{attrs:{icon:"../../../static/market/trumpet.png",msgs:t.notices,mpcomid:"2763a7ef-0"}}),a("view",{staticClass:"grace-cate",staticStyle:{width:"100%",height:"calc(100% - 90px)"}},[a("scroll-view",{staticClass:"grace-cate-left",attrs:{"scroll-y":"","scroll-into-view":t.leftTo}},t._l(t.mainCate,function(e,i){return a("view",{key:i,class:["item",t.currentCateIndex==e.cateid?"current":""],attrs:{"data-cateid":e.cateid,id:"cate"+e.cateid,eventid:"2763a7ef-0-"+i},on:{tap:t.changCate}},[t._v(t._s(e.title))])})),a("scroll-view",{staticClass:"grace-cate-right",attrs:{"scroll-y":"","scroll-into-view":t.productListTo,eventid:"2763a7ef-2"},on:{scroll:t.rscroll}},t._l(t.mainCate,function(e,i){return a("block",{key:i},[a("view",{staticClass:"grace-title grace-nowrap grace-space-between",staticStyle:{"margin-top":"15px"},attrs:{id:"productList"+e.cateid}},[a("view",{staticClass:"grace-h5 grace-blod"},[t._v(t._s(e.title))])]),a("view",{staticClass:"grace-news-list"},t._l(t.allProducts["cateproducts"+e.cateid],function(e,n){return a("view",{key:n,staticClass:"grace-news-list-items"},[a("image",{staticClass:"grace-news-list-img grace-list-imgs-l",attrs:{src:e.img,mode:"widthFix"}}),a("view",{staticClass:"grace-news-list-title"},[a("view",{staticClass:"grace-news-list-title-main"},[t._v(t._s(e.title))]),a("view",{staticClass:"price"},[t._v("￥"+t._s(e.price))]),a("view",[a("view",{staticClass:"grace-add-to-card",attrs:{"data-product":e,eventid:"2763a7ef-1-"+i+"-"+n},on:{tap:t.addtocard}},[t._v("+")])])])])}))])}))],1),a("view",{staticClass:"grace-footer"},[a("view",{staticStyle:{width:"60%"}},[a("view",{staticClass:"icons iconfont icon-gouwuche",attrs:{eventid:"2763a7ef-3"},on:{click:t.showShppingcard}},[t.shoppingCart.length>0?a("text",{staticClass:"grace-badge grace-badge-red"},[t._v(t._s(t.shoppingCart.length))]):t._e()]),a("view",{staticClass:"icons iconfont icon-lianxikefu"}),a("view",{staticClass:"icons iconfont icon-jiahao"})]),a("view",{staticStyle:{width:"40%"}},[a("button",{attrs:{type:"warn",eventid:"2763a7ef-4"},on:{click:t.settleAccounts}},[t._v("立即结算")])],1)]),a("popup-layer",{ref:"popup",attrs:{direction:t.direction,mpcomid:"2763a7ef-2"}},[0===t.shoppingCart.length?a("view",{staticStyle:{"text-align":"center",color:"grey","line-height":"80px"}},[t._v("购物车内空空如也(＞﹏＜)")]):a("view",{staticClass:"grace-form"},[a("view",{staticStyle:{padding:"0 8rpx"}},t._l(t.shoppingCart,function(e,i){return a("view",{key:i,staticClass:"grace-items"},[a("view",{staticClass:"iconss"},[a("image",{staticStyle:{width:"50rpx",height:"50rpx"},attrs:{src:e.img,mode:"widthFix"}})]),a("view",{staticClass:"grace-label"},[t._v(t._s(e.title))]),a("graceNumberBox",{attrs:{minNum:"0",value:e.count,index:i,eventid:"2763a7ef-5-"+i,mpcomid:"2763a7ef-1-"+i},on:{change:t.change}})],1)}))])])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},b2e6:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"grace-number-box"},[a("view",{staticClass:"doBtn",attrs:{eventid:"0b6f14c8-0"},on:{tap:t.reduce}},[t._v("-")]),a("input",{attrs:{type:"number",value:t.inputNumber,disabled:t.disabled,eventid:"0b6f14c8-1"},on:{blur:t.blur}}),a("view",{staticClass:"doBtn",attrs:{eventid:"0b6f14c8-2"},on:{tap:t.add}},[t._v("+")])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},c52d:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"popup-layer",props:{direction:{type:String,default:"top"}},data:function(){return{ifshow:!1,translateValue:-100,timer:null,iftoggle:!1}},computed:{_translate:function(){var t={top:"transform:translateY(".concat(-this.translateValue,"%)"),bottom:"transform:translateY(".concat(this.translateValue,"%)"),left:"transform:translateX(".concat(-this.translateValue,"%)"),right:"transform:translateX(".concat(this.translateValue,"%)")};return t[this.direction]},_location:function(){var t={top:"bottom:0px;width:100%;",bottom:"top:0px;width:100%;",left:"right:0px;height:100%;",right:"left:0px;height:100%;"};return t[this.direction]+this._translate}},methods:{show:function(){var t=this;this.ifshow=!0;setTimeout(function(){t.translateValue=0,null},100),setTimeout(function(){t.iftoggle=!0,null},300)},close:function(){var t=this;null===this.timer&&this.iftoggle&&(this.translateValue=-100,this.timer=setTimeout(function(){t.ifshow=!1,t.timer=null,t.iftoggle=!1},300))},stopEvent:function(t){}}};e.default=i},d83c:function(t,e,a){},df34:function(t,e,a){"use strict";a.r(e);var i=a("49a8"),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e["default"]=n.a},e15a:function(t,e,a){},e521:function(t,e,a){"use strict";a.r(e);var i=a("81c5"),n=a("ea20");for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a("6a77");var s=a("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},e819:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"grace-swiper-msg"},[a("view",{staticClass:"grace-swiper-msg-icon"},[a("image",{attrs:{src:t.icon,mode:"widthFix"}})]),a("swiper",{attrs:{vertical:t.vertical,autoplay:"true",circular:"true",interval:t.interval}},t._l(t.msgs,function(e,i){return a("swiper-item",{key:i,attrs:{mpcomid:"02770485-0-"+i}},[a("navigator",{attrs:{url:e.url,"open-type":e.opentype}},[t._v(t._s(e.title))])],1)}))],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},e8dc:function(t,e,a){"use strict";a.r(e);var i=a("b2e6"),n=a("df34");for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a("48a3");var s=a("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},ea20:function(t,e,a){"use strict";a.r(e);var i=a("ec67"),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e["default"]=n.a},ec67:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("2f62"),n=c(a("5249")),r=c(a("e8dc")),s=c(a("56a3"));function c(t){return t&&t.__esModule?t:{default:t}}var o=null,u=100,l={components:{graceNumberBox:r.default,popupLayer:n.default,graceSpeaker:s.default},data:function(){return{popmenuShowX:!0,notices:[],currentCateIndex:1,leftTo:"cate1",productListTo:"productList1",mainCate:[],allProducts:{},marketId:0,goodsCount:0,shoppingCart:[]}},computed:(0,i.mapState)(["user"]),onLoad:function(e){var a=this;t.getSystemInfo({success:function(t){u=t.windowHeight}}),t.setNavigationBarTitle({title:e.market_name}),this.notices=JSON.parse(e.notices),this.marketId=e.market_id,t.request({url:this.GLOBAL.serverSrc+"market/product/select",method:"GET",data:{token:this.user.token,market_id:this.marketId},success:function(t){200===t.data.status&&(a.allProducts=t.data.allProduct,a.mainCate=t.data.mainCate)},fail:function(t){a.GLOBAL.requestFail(t)}})},methods:{changCate:function(t){var e=t.currentTarget.dataset.cateid;this.currentCateIndex=e,this.leftTo="cate"+e,this.productListTo="productList"+e},rscroll:function(t){var e=t.detail.scrollTop;null!=o&&clearTimeout(o),o=setTimeout(function(){this.getIndex(0,e)}.bind(this),80)},getIndex:function(t,e){var a=this,i=wx.createSelectorQuery();i.select("#productList"+this.mainCate[t].cateid).boundingClientRect(),i.selectViewport().scrollOffset(),i.exec(function(i){i[0].top+u/2>0?(a.currentCateIndex=a.mainCate[t].cateid,a.leftTo="cate"+a.mainCate[t].cateid):(t++,t<a.mainCate.length&&a.getIndex(t,e))})},addtocard:function(e){this.goodsCount++;var a=e.currentTarget.dataset.product;void 0!=this.shoppingCart.find(function(t){return t.id===a.id})?t.showToast({title:"购物车已存在此商品\n请点击左下角购物车查看",icon:"none"}):(a.count=1,this.shoppingCart.push(a))},showmenuX:function(){this.popmenuShowX=!this.popmenuShowX},showShppingcard:function(){this.$refs.popup.show()},change:function(t){var e=t[1],a=t[0];this.shoppingCart[e].count=a},settleAccounts:function(){var e=this;0===this.shoppingCart.length?this.$refs.popup.show():(t.showLoading({title:"加载中"}),t.request({url:this.GLOBAL.serverSrc+"pay/create_order/create",method:"POST",data:{user_id:this.user.id,shopping_cart:this.shoppingCart},success:function(e){t.hideLoading(),200===e.data.status?t.navigateTo({url:"./checkstand?order_id="+e.data.order_id+"&real_price="+e.data.real_price}):t.showToast({title:e.data.msg,icon:"none"})},fail:function(a){t.hideLoading(),e.GLOBAL.requestFail(a)}}))}}};e.default=l}).call(this,a("6e42")["default"])},ec83:function(t,e,a){"use strict";a("859d");var i=r(a("b0ce")),n=r(a("e521"));function r(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},f66e:function(t,e,a){}},[["ec83","common/runtime","common/vendor"]]]);