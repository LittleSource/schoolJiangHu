(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/confession/publish"],{"2b32":function(t,e,i){"use strict";i.r(e);var n=i("bfab"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},"4a26":function(t,e,i){},"61d5":function(t,e,i){"use strict";var n=i("4a26"),a=i.n(n);a.a},"6d23":function(t,e,i){"use strict";i("7f79");var n=s(i("b0ce")),a=s(i("adc6"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(a.default))},adc6:function(t,e,i){"use strict";i.r(e);var n=i("fd45"),a=i("2b32");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("61d5");var o=i("2877"),r=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"69b983da",null);e["default"]=r.exports},bfab:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,a=i("2f62"),s=9,o={data:function(){return{content:"",imgLists:[],imgFiles:[],btnImg:!0}},onLoad:function(){n=this},computed:(0,a.mapState)(["user"]),methods:{addImg:function(){var e=s-n.imgLists.length;if(e<1)return!1;t.chooseImage({count:e,sizeType:["compressed"],success:function(t){n.imgFiles=n.imgFiles.concat(t.tempFiles),n.imgLists=n.imgLists.concat(t.tempFilePaths),n.imgLists.length>=s&&(n.btnImg=!1)}})},removeImg:function(t){var e=t.currentTarget.id.replace("grace-items-img-","");n.imgLists.splice(e,1),n.imgFiles.splice(e,1),n.imgLists.length<s&&(n.btnImg=!0)},showImgs:function(e){var i=e.currentTarget.dataset.imgurl;t.previewImage({urls:this.imgLists,current:i})},submit:function(){this.Loading=!0;var e=0,i=this,a=[];t.showLoading({title:"发布中..."}),this.imgFiles.length>0?(a=this.imgFiles.map(function(t){return{name:"file["+e+++"]",uri:t.path}}),t.uploadFile({url:n.GLOBAL.serverSrc+"confession/publish/upload",files:a,formData:{token:n.user.token,phone:n.user.phone,content:n.content},success:function(e){console.log(JSON.stringify(e));var i=JSON.parse(e.data);t.hideLoading(),200===i.status?(t.showToast({title:"发表成功！",icon:"none"}),t.redirectTo({url:"./index"})):t.showToast({title:i.msg,icon:"none"})},fail:function(e){t.hideLoading(),i.GLOBAL.requestFail(e)}})):t.request({url:n.GLOBAL.serverSrc+"confession/publish/upload",method:"POST",data:{token:n.user.token,phone:n.user.phone,content:n.content},success:function(e){t.hideLoading(),200===e.data.status&&(t.showToast({title:"发表成功！",icon:"none"}),t.redirectTo({url:"./index"}))},fail:function(e){t.hideLoading(),i.GLOBAL.requestFail(e)}})}}};e.default=o}).call(this,i("6e42")["default"])},fd45:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"grace-bg-white"},[i("view",{staticClass:"grace-items grace-noborder grace-padding input-textarea"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticStyle:{width:"100%"},attrs:{placeholder:"这一刻的想法...",maxlength:"200",eventid:"3faa052b-0"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),i("view",{staticClass:"grace-common-mt"},[i("view",{staticClass:"grace-add-file"},[t.btnImg?i("view",{staticClass:"grace-add-btn",attrs:{eventid:"3faa052b-1"},on:{tap:t.addImg}},[i("view",[t._v("+")]),i("view",[t._v("添加照片")])]):t._e(),t._l(t.imgLists,function(e,n){return i("view",{key:n,staticClass:"garce-items"},[i("image",{attrs:{src:e,mode:"widthFix","data-imgurl":e,eventid:"3faa052b-2-"+n},on:{tap:t.showImgs}}),i("view",{staticClass:"grace-close",attrs:{id:"grace-items-img-"+n,eventid:"3faa052b-3-"+n},on:{tap:t.removeImg}})])})],2)]),i("view",{staticClass:"grace-padding has-bordert"},[i("button",{staticClass:"ymkj-bg",attrs:{type:"default",eventid:"3faa052b-4"},on:{click:t.submit}},[t._v("提交")])],1)])},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})}},[["6d23","common/runtime","common/vendor"]]]);