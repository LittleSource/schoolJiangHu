(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/market/classify"],{"37d7":function(t,e,s){},5943:function(t,e,s){"use strict";s.r(e);var i=s("630d"),a=s("d4ee");for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);s("7dd0");var o=s("2877"),c=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},"630d":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",[0==t.catesList.length?s("view",{staticClass:"margin-top text-center grey"},[t._v("暂无分类，请点击下面按钮添加")]):t._e(),t._l(t.catesList,function(e,i){return t.catesList.length>0?s("view",{key:i,staticClass:"cu-form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"cate.title"}],staticClass:"radius",attrs:{placeholder:"请输入分类名称",eventid:"6e291bf7-0-"+i},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}}),s("button",{staticClass:"mini-btn bg-green shadow",attrs:{eventid:"6e291bf7-1-"+i},on:{click:function(e){t.sortUp(i)}}},[s("text",{staticClass:"grace-iconfont icon-arrow-up"})]),s("button",{staticClass:"mini-btn bg-green shadow",attrs:{eventid:"6e291bf7-2-"+i},on:{click:function(e){t.sortDown(i)}}},[s("text",{staticClass:"grace-iconfont icon-arrow-down"})]),s("button",{staticClass:"cu-btn bg-orange shadow",attrs:{eventid:"6e291bf7-3-"+i},on:{click:function(e){t.deleteCate(i)}}},[t._v("删除")])],1):t._e()}),s("view",{staticClass:"margin-top padding flex flex-direction"},[s("button",{staticClass:"cu-btn lg bg-blue shadow",attrs:{eventid:"6e291bf7-4"},on:{click:t.addCate}},[t._v("添加分类")]),s("button",{staticClass:"cu-btn lg shadow save",staticStyle:{"background-color":"#FC4243"},attrs:{loading:t.btnLoading,eventid:"6e291bf7-5"},on:{click:t.submit}},[t._v("完成编辑")])],1)],2)},a=[];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return a})},"7dd0":function(t,e,s){"use strict";var i=s("37d7"),a=s.n(i);a.a},b89b:function(t,e,s){"use strict";s("859d");var i=n(s("b0ce")),a=n(s("5943"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},d4ee:function(t,e,s){"use strict";s.r(e);var i=s("f51f"),a=s.n(i);for(var n in i)"default"!==n&&function(t){s.d(e,t,function(){return i[t]})}(n);e["default"]=a.a},f51f:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s("2f62"),a={data:function(){return{marketId:0,catesList:[],btnLoading:!1}},computed:(0,i.mapState)(["user"]),onLoad:function(e){var s=this,i=t.getStorageSync("market");i.isMarket?(this.marketId=i.marketId,t.showLoading({title:"加载中..."}),t.request({url:this.GLOBAL.serverSrc+"market/management/productcate",method:"GET",data:{market_id:this.marketId},success:function(e){200===e.data.status?s.catesList=e.data.catesList:t.showToast({title:e.data.msg,icon:"none"})},fail:function(t){s.GLOBAL.requestFail(t)},complete:function(){t.hideLoading()}})):t.showToast({title:"系统错误",icon:"none"})},methods:{addCate:function(){if(this.catesList.length>=10)t.showToast({title:"分类最大上限10个",icon:"none"});else{var e=1;this.catesList.length>0&&(e=this.catesList[this.catesList.length-1].ord+1);var s={cateid:null,ord:e,title:"",count:0,market_id:this.marketId};this.catesList.push(s)}},deleteCate:function(e){if(this.catesList[e].count>0)t.showToast({title:"该分类下存在商品，无法删除",icon:"none"});else{var s=this;t.showModal({title:"提示",content:"确定删除 "+this.catesList[e].title+" 分类吗？",success:function(t){t.confirm&&s.catesList.splice(e,1)}})}},sortUp:function(t){if(0!==t){var e=this.catesList[t].ord;this.catesList[t].ord=this.catesList[t-1].ord,this.catesList[t-1].ord=e,this.catesList=this.swapArray(this.catesList,t,t-1)}},sortDown:function(t){if(t+1!==this.catesList.length){var e=this.catesList[t].ord;this.catesList[t].ord=this.catesList[t+1].ord,this.catesList[t+1].ord=e,this.catesList=this.swapArray(this.catesList,t,t+1)}},submit:function(){for(var e=this,s=0;s<this.catesList.length;s++)if(""===this.catesList[s].title)return void t.showToast({title:"第"+(s+1)+"个分类名称不能为空",icon:"none"});this.btnLoading=!0,t.request({url:this.GLOBAL.serverSrc+"market/category/update",method:"POST",data:{market_id:this.marketId,phone:this.user.phone,token:this.user.token,cateList:this.catesList},success:function(e){200===e.data.status?(t.showToast({title:"操作成功",mask:!1,duration:1500}),setTimeout(function(){t.navigateBack()},1e3)):t.showToast({title:e.data.msg,icon:"none"})},fail:function(t){e.GLOBAL.requestFail(t)},complete:function(){e.btnLoading=!1}})},swapArray:function(t,e,s){return t[e]=t.splice(s,1,t[e])[0],t}}};e.default=a}).call(this,s("6e42")["default"])}},[["b89b","common/runtime","common/vendor"]]]);