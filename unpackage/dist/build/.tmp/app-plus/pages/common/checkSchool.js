(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/checkSchool"],{"0998":function(t,e,o){"use strict";o.r(e);var n=o("986a"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);e["default"]=i.a},"1d8d":function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,o){return e&&i(t.prototype,e),o&&i(t,o),t}var a={KEY_ERR:311,KEY_ERR_MSG:"key格式错误",PARAM_ERR:310,PARAM_ERR_MSG:"请求参数信息有误",SYSTEM_ERR:600,SYSTEM_ERR_MSG:"系统错误",WX_ERR_CODE:1e3,WX_OK_CODE:200},l="https://apis.map.qq.com/ws/",r=l+"place/v1/search",c=l+"place/v1/suggestion",u=l+"geocoder/v1/",d=l+"district/v1/list",f=l+"district/v1/getchildren",g=l+"distance/v1/",p=6378136.49,_={location2query:function(t){if("string"==typeof t)return t;for(var e="",o=0;o<t.length;o++){var n=t[o];e&&(e+=";"),n.location&&(e=e+n.location.lat+","+n.location.lng),n.latitude&&n.longitude&&(e=e+n.latitude+","+n.longitude)}return e},rad:function(t){return t*Math.PI/180},getEndLocation:function(t){for(var e=t.split(";"),o=[],n=0;n<e.length;n++)o.push({lat:parseFloat(e[n].split(",")[0]),lng:parseFloat(e[n].split(",")[1])});return o},getDistance:function(t,e,o,n){var i=this.rad(t),s=this.rad(o),a=i-s,l=this.rad(e)-this.rad(n),r=2*Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2)+Math.cos(i)*Math.cos(s)*Math.pow(Math.sin(l/2),2)));return r*=p,r=Math.round(1e4*r)/1e4,parseFloat(r.toFixed(0))},getWXLocation:function(t,e,o){wx.getLocation({type:"gcj02",success:t,fail:e,complete:o})},getLocationParam:function(t){if("string"==typeof t){var e=t.split(",");t=2===e.length?{latitude:t.split(",")[0],longitude:t.split(",")[1]}:{}}return t},polyfillParam:function(t){t.success=t.success||function(){},t.fail=t.fail||function(){},t.complete=t.complete||function(){}},checkParamKeyEmpty:function(t,e){if(!t[e]){var o=this.buildErrorConfig(a.PARAM_ERR,a.PARAM_ERR_MSG+e+"参数格式有误");return t.fail(o),t.complete(o),!0}return!1},checkKeyword:function(t){return!this.checkParamKeyEmpty(t,"keyword")},checkLocation:function(t){var e=this.getLocationParam(t.location);if(!e||!e.latitude||!e.longitude){var o=this.buildErrorConfig(a.PARAM_ERR,a.PARAM_ERR_MSG+" location参数格式有误");return t.fail(o),t.complete(o),!1}return!0},buildErrorConfig:function(t,e){return{status:t,message:e}},handleData:function(t,e,o){if("search"===o){for(var n=e.data,i=[],s=0;s<n.length;s++)i.push({id:n[s].id||null,title:n[s].title||null,latitude:n[s].location&&n[s].location.lat||null,longitude:n[s].location&&n[s].location.lng||null,address:n[s].address||null,category:n[s].category||null,tel:n[s].tel||null,adcode:n[s].ad_info&&n[s].ad_info.adcode||null,city:n[s].ad_info&&n[s].ad_info.city||null,district:n[s].ad_info&&n[s].ad_info.district||null,province:n[s].ad_info&&n[s].ad_info.province||null});t.success(e,{searchResult:n,searchSimplify:i})}else if("suggest"===o){var a=e.data,l=[];for(s=0;s<a.length;s++)l.push({adcode:a[s].adcode||null,address:a[s].address||null,category:a[s].category||null,city:a[s].city||null,district:a[s].district||null,id:a[s].id||null,latitude:a[s].location&&a[s].location.lat||null,longitude:a[s].location&&a[s].location.lng||null,province:a[s].province||null,title:a[s].title||null,type:a[s].type||null});t.success(e,{suggestResult:a,suggestSimplify:l})}else if("reverseGeocoder"===o){var r=e.result,c={address:r.address||null,latitude:r.location&&r.location.lat||null,longitude:r.location&&r.location.lng||null,adcode:r.ad_info&&r.ad_info.adcode||null,city:r.address_component&&r.address_component.city||null,district:r.address_component&&r.address_component.district||null,nation:r.address_component&&r.address_component.nation||null,province:r.address_component&&r.address_component.province||null,street:r.address_component&&r.address_component.street||null,street_number:r.address_component&&r.address_component.street_number||null,recommend:r.formatted_addresses&&r.formatted_addresses.recommend||null,rough:r.formatted_addresses&&r.formatted_addresses.rough||null};if(r.pois){var u=r.pois,d=[];for(s=0;s<u.length;s++)d.push({id:u[s].id||null,title:u[s].title||null,latitude:u[s].location&&u[s].location.lat||null,longitude:u[s].location&&u[s].location.lng||null,address:u[s].address||null,category:u[s].category||null,adcode:u[s].ad_info&&u[s].ad_info.adcode||null,city:u[s].ad_info&&u[s].ad_info.city||null,district:u[s].ad_info&&u[s].ad_info.district||null,province:u[s].ad_info&&u[s].ad_info.province||null});t.success(e,{reverseGeocoderResult:r,reverseGeocoderSimplify:c,pois:u,poisSimplify:d})}else t.success(e,{reverseGeocoderResult:r,reverseGeocoderSimplify:c})}else if("geocoder"===o){var f=e.result,g={title:f.title||null,latitude:f.location&&f.location.lat||null,longitude:f.location&&f.location.lng||null,adcode:f.ad_info&&f.ad_info.adcode||null,province:f.address_components&&f.address_components.province||null,city:f.address_components&&f.address_components.city||null,district:f.address_components&&f.address_components.district||null,street:f.address_components&&f.address_components.street||null,street_number:f.address_components&&f.address_components.street_number||null,level:f.level||null};t.success(e,{geocoderResult:f,geocoderSimplify:g})}else if("getCityList"===o){var p=e.result[0],_=e.result[1],h=e.result[2];t.success(e,{provinceResult:p,cityResult:_,districtResult:h})}else if("getDistrictByCityId"===o){var m=e.result[0];t.success(e,m)}else if("calculateDistance"===o){var v=e.result.elements,y=[];for(s=0;s<v.length;s++)y.push(v[s].distance);t.success(e,{calculateDistanceResult:v,distance:y})}else t.success(e)},buildWxRequestConfig:function(t,e,o){var n=this;return e.header={"content-type":"application/json"},e.method="GET",e.success=function(e){var i=e.data;0===i.status?n.handleData(t,i,o):t.fail(i)},e.fail=function(e){e.statusCode=a.WX_ERR_CODE,t.fail(n.buildErrorConfig(a.WX_ERR_CODE,e.errMsg))},e.complete=function(e){var o=+e.statusCode;switch(o){case a.WX_ERR_CODE:t.complete(n.buildErrorConfig(a.WX_ERR_CODE,e.errMsg));break;case a.WX_OK_CODE:var i=e.data;0===i.status?t.complete(i):t.complete(n.buildErrorConfig(i.status,i.message));break;default:t.complete(n.buildErrorConfig(a.SYSTEM_ERR,a.SYSTEM_ERR_MSG))}},e},locationProcess:function(t,e,o,n){var i=this;if(o=o||function(e){e.statusCode=a.WX_ERR_CODE,t.fail(i.buildErrorConfig(a.WX_ERR_CODE,e.errMsg))},n=n||function(e){e.statusCode==a.WX_ERR_CODE&&t.complete(i.buildErrorConfig(a.WX_ERR_CODE,e.errMsg))},t.location){if(i.checkLocation(t)){var s=_.getLocationParam(t.location);e(s)}}else i.getWXLocation(e,o,n)}},h=function(){function t(e){if(n(this,t),!e.key)throw Error("key值不能为空");this.key=e.key}return s(t,[{key:"search",value:function(t){var e=this;if(t=t||{},_.polyfillParam(t),_.checkKeyword(t)){var o={keyword:t.keyword,orderby:t.orderby||"_distance",page_size:t.page_size||10,page_index:t.page_index||1,output:"json",key:e.key};t.address_format&&(o.address_format=t.address_format),t.filter&&(o.filter=t.filter);var n=t.distance||"1000",i=t.auto_extend||1,s=null,a=null;t.region&&(s=t.region),t.rectangle&&(a=t.rectangle);var l=function(e){o.boundary=s&&!a?"region("+s+","+i+","+e.latitude+","+e.longitude+")":a&&!s?"rectangle("+a+")":"nearby("+e.latitude+","+e.longitude+","+n+","+i+")",wx.request(_.buildWxRequestConfig(t,{url:r,data:o},"search"))};_.locationProcess(t,l)}}},{key:"getSuggestion",value:function(t){var e=this;if(t=t||{},_.polyfillParam(t),_.checkKeyword(t)){var o={keyword:t.keyword,region:t.region||"全国",region_fix:t.region_fix||0,policy:t.policy||0,page_size:t.page_size||10,page_index:t.page_index||1,get_subpois:t.get_subpois||0,output:"json",key:e.key};if(t.address_format&&(o.address_format=t.address_format),t.filter&&(o.filter=t.filter),t.location){var n=function(e){o.location=e.latitude+","+e.longitude,wx.request(_.buildWxRequestConfig(t,{url:c,data:o},"suggest"))};_.locationProcess(t,n)}else wx.request(_.buildWxRequestConfig(t,{url:c,data:o},"suggest"))}}},{key:"reverseGeocoder",value:function(t){var e=this;t=t||{},_.polyfillParam(t);var o={coord_type:t.coord_type||5,get_poi:t.get_poi||0,output:"json",key:e.key};t.poi_options&&(o.poi_options=t.poi_options);var n=function(e){o.location=e.latitude+","+e.longitude,wx.request(_.buildWxRequestConfig(t,{url:u,data:o},"reverseGeocoder"))};_.locationProcess(t,n)}},{key:"geocoder",value:function(t){var e=this;if(t=t||{},_.polyfillParam(t),!_.checkParamKeyEmpty(t,"address")){var o={address:t.address,output:"json",key:e.key};t.region&&(o.region=t.region),wx.request(_.buildWxRequestConfig(t,{url:u,data:o},"geocoder"))}}},{key:"getCityList",value:function(t){var e=this;t=t||{},_.polyfillParam(t);var o={output:"json",key:e.key};wx.request(_.buildWxRequestConfig(t,{url:d,data:o},"getCityList"))}},{key:"getDistrictByCityId",value:function(t){var e=this;if(t=t||{},_.polyfillParam(t),!_.checkParamKeyEmpty(t,"id")){var o={id:t.id||"",output:"json",key:e.key};wx.request(_.buildWxRequestConfig(t,{url:f,data:o},"getDistrictByCityId"))}}},{key:"calculateDistance",value:function(t){var e=this;if(t=t||{},_.polyfillParam(t),!_.checkParamKeyEmpty(t,"to")){var o={mode:t.mode||"walking",to:_.location2query(t.to),output:"json",key:e.key};if(t.from&&(t.location=t.from),"straight"==o.mode){var n=function(e){for(var n=_.getEndLocation(o.to),i={message:"query ok",result:{elements:[]},status:0},s=0;s<n.length;s++)i.result.elements.push({distance:_.getDistance(e.latitude,e.longitude,n[s].lat,n[s].lng),duration:0,from:{lat:e.latitude,lng:e.longitude},to:{lat:n[s].lat,lng:n[s].lng}});var a=i.result.elements,l=[];for(s=0;s<a.length;s++)l.push(a[s].distance);return t.success(i,{calculateResult:a,distanceResult:l})};_.locationProcess(t,n)}else{n=function(e){o.from=e.latitude+","+e.longitude,wx.request(_.buildWxRequestConfig(t,{url:g,data:o},"calculateDistance"))};_.locationProcess(t,n)}}}}]),t}();t.exports=h},"45fc":function(t,e,o){"use strict";o("859d");var n=s(o("b0ce")),i=s(o("5303"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(i.default))},5303:function(t,e,o){"use strict";o.r(e);var n=o("66c8"),i=o("0998");for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);var a=o("2877"),l=Object(a["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=l.exports},"66c8":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",[0===t.schoolList.length?o("view",{staticClass:"grace-center",staticStyle:{"font-size":"32rpx",color:"#2F2F2F"}},[t._v("当前学校:"+t._s(t.nowSchool.title))]):t._e(),t.schoolList.length>0?o("view",{staticClass:"grace-list"},t._l(t.schoolList,function(e,n){return o("view",{key:n,staticClass:"items",attrs:{eventid:"691dc3db-0-"+n},on:{click:function(e){t.setSchool(t.schoolList[n])}}},[o("view",{staticClass:"title"},[t._v(t._s(e.title))]),o("view",{staticClass:"arrow-right"})])})):t._e(),o("simpleDialog",{ref:"simpleDialog2",attrs:{eventid:"691dc3db-1",mpcomid:"691dc3db-0"},on:{confirmButton:t.confirmButton}})],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},"986a":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("eab9")),i=s(o("1d8d"));function s(t){return t&&t.__esModule?t:{default:t}}var a=new i.default({key:"7YDBZ-4ATCD-5GM4Z-HCI5B-4ECM6-PPBXO"}),l={components:{simpleDialog:n.default},data:function(){return{schoolList:[],nowSchool:{}}},onLoad:function(){this.nowSchool=t.getStorageSync("school")},onNavigationBarSearchInputChanged:function(t){if(""!==t.text){var e=this;a.getSuggestion({keyword:t.text,filter:"category=大学,中学",success:function(t){for(var o=[],n=0;n<t.data.length;n++)o.push({id:t.data[n].id,title:t.data[n].title,addr:t.data[n].address});e.schoolList=o},fail:function(t){console.error(JSON.stringify(t))}})}else this.schoolList=[]},methods:{setSchool:function(t){this.nowSchool=t,this.$refs.simpleDialog2.confirm({title:"提示",message:"确定切换到"+t.title+"吗？ 学校位置:"+t.addr})},confirmButton:function(){t.setStorage({key:"school",data:this.nowSchool,fail:function(){t.showModal({title:"提示",content:"学校切换失败！",showCancel:!1})},complete:function(){t.switchTab({url:"/pages/index/index"})}})}}};e.default=l}).call(this,o("649d")["default"])},a531:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{title:{type:String,default:""},message:{type:String,default:"你怎么会看到我^_^"},contentClass:{type:String,default:"has-pd-50 has-bg-white"},messageAlign:{type:String,default:"center"},showConfirmButton:{type:Boolean,default:!0},showCancelButton:{type:Boolean,default:!1},confirmButtonText:{type:String,default:"确定"},cancelButtonText:{type:String,default:"取消"}},data:function(){return{isVisibility:!1}},methods:{__show:function(){this.isVisibility=!0},__close:function(){this.isVisibility=!1},__setconfig:function(t){void 0!=t&&"object"==typeof t&&(void 0!=t["title"]&&(this.title=t["title"]),void 0!=t["message"]&&(this.message=t["message"]),void 0!=t["contentClass"]&&(this.contentClass=t["contentClass"]),void 0!=t["messageAlign"]&&(this.messageAlign=t["messageAlign"]),void 0!=t["showConfirmButton"]&&(this.showConfirmButton=t["showConfirmButton"]),void 0!=t["showCancelButton"]&&(this.showCancelButton=t["showCancelButton"]),void 0!=t["confirmButtonText"]&&(this.confirmButtonText=t["confirmButtonText"]),void 0!=t["cancelButtonText"]&&(this.cancelButtonText=t["cancelButtonText"]))},alert:function(t){this.__setconfig(t),this.__show()},confirm:function(t){this.showCancelButton=!0,this.__setconfig(t),this.__show()},handleClose:function(){this.__close(),this.$emit("cancelButton")},handleConfirm:function(){this.__close(),this.$emit("confirmButton")}}};e.default=n},cb49:function(t,e,o){"use strict";o.r(e);var n=o("a531"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);e["default"]=i.a},eab9:function(t,e,o){"use strict";o.r(e);var n=o("f6a1"),i=o("cb49");for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);var a=o("2877"),l=Object(a["a"])(i["default"],n["a"],n["b"],!1,null,"61969652",null);e["default"]=l.exports},f6a1:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",{},[o("view",{staticClass:"modal-box ",class:t.isVisibility?"show":""},[o("view",{staticClass:"dialog"},[""!=t.title?o("view",{staticClass:"simple-bar justify-end has-borderb"},[o("view",{staticClass:"content"},[t._v(t._s(t.title))])]):t._e(),o("view",{class:t.contentClass,style:"text-align:"+t.messageAlign},[t._v(t._s(t.message))]),o("view",{staticClass:"simple-bar has-bordert"},[1==t.showCancelButton?o("view",{staticClass:"action has-mg-0 flex-sub text-green",attrs:{eventid:"3b86ca29-0"},on:{tap:t.handleClose}},[t._v(t._s(t.cancelButtonText))]):t._e(),1==t.showConfirmButton?o("view",{staticClass:"action has-mg-0 flex-sub has-borderl",attrs:{eventid:"3b86ca29-1"},on:{tap:t.handleConfirm}},[t._v(t._s(t.confirmButtonText))]):t._e()])])])])},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})}},[["45fc","common/runtime","common/vendor"]]]);