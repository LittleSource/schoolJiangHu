(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/main"],{"2c83":function(e,t,o){"use strict";o("859d");var n=a(o("f3d3")),r=a(o("ed8f")),u=a(o("e233")),s=a(o("9778"));function a(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){i(e,t,o[t])})}return e}function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}n.default.config.productionTip=!1,n.default.prototype.GLOBAL=u.default,n.default.prototype.$store=s.default,r.default.mpType="app";var l=new n.default(c({store:s.default},r.default));l.$mount()},"3c04":function(e,t,o){"use strict";o.r(t);var n=o("e6b7"),r=o.n(n);for(var u in n)"default"!==u&&function(e){o.d(t,e,function(){return n[e]})}(u);t["default"]=r.a},"799b":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div")},r=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return r})},"8cc7":function(e,t,o){},"8d42":function(e,t,o){"use strict";var n=o("8cc7"),r=o.n(n);r.a},9778:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(o("f3d3")),r=u(o("2f62"));function u(e){return e&&e.__esModule?e:{default:e}}n.default.use(r.default);var s=new r.default.Store({state:{user:{hasLogin:!1,id:0,token:"",phone:"",avatar:"",password:"",userName:"",sex:0},school:{id:"11853391869743621792",title:"",addr:""},selectSchool:{id:"11853391869743621792",title:"",addr:""},msg:[{toId:69,img:"../../../static/logo.png",title:"to蛇皮",desc:"在干啥？",status:"未读",unread:1},{toId:67,img:"../../../static/logo.png",title:"to源哥",desc:"我刚刚去看电影了",status:"未读",unread:1},{toId:85,img:"../../../static/logo.png",title:"狸猫",desc:"怎么说呢",status:"未读",unread:1}]},mutations:{regSetPhoneAndPass:function(e,t){e.user.phone=t.phone,e.user.password=t.password},regSetSex:function(e,t){e.user.sex=t},regSetSchool:function(e,t){e.school=t,e.selectSchool=t},regSetAvatar:function(e,t){e.user.avatar=t},regSetUserName:function(e,t){e.user.userName=t},regAfterLogin:function(e,t){e.user.id=t.user.user_id,e.user.phone=t.user.phone,e.user.sex=t.user.sex,e.user.userName=t.user.user_name,e.user.avatar=t.user.avatar,e.user.token=t.token,e.user.password="",e.user.hasLogin=!0,this.commit("loginAfterSetStorage")},login:function(e,t){e.user.id=t.user.user_id,e.user.phone=t.user.phone,e.user.sex=t.user.sex,e.user.userName=t.user.user_name,e.user.avatar=t.user.avatar,e.user.token=t.token,e.school=t.school,e.selectSchool=e.school,e.user.hasLogin=!0,this.commit("loginAfterSetStorage")},logOut:function(t){t.hasLogin=!1,e.clearStorage()},loginAfterSetStorage:function(t){e.setStorage({key:"user",data:t.user}),e.setStorage({key:"school",data:t.school}),e.setStorage({key:"selectSchool",data:t.selectSchool})},checkSchool:function(t,o){t.selectSchool=o,e.setStorage({key:"selectSchool",data:o,fail:function(){e.showModal({title:"提示",content:"学校切换失败！",showCancel:!1})}})},appOnLunch:function(e,t){e.user=t.user,e.school=t.school,e.selectSchool=t.selectSchool},addMsg:function(e,t){for(var o=!1,n=0;n<e.msg.length;n++)if(e.msg[n].toId===t.toId){o=!0;break}o?(e.msg[n].msg=t.msg,e.msg[n].unread+=1):e.msg.unshift(t)},delMsg:function(e,t){e.msg.splice(0,1)}}}),a=s;t.default=a}).call(this,o("649d")["default"])},a08b:function(e,t,o){"use strict";o.r(t);var n=o("c4ab"),r=o.n(n);for(var u in n)"default"!==u&&function(e){o.d(t,e,function(){return n[e]})}(u);t["default"]=r.a},c4ab:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o="ws://www.hckj99.cn:8282",n="http://www.hckj99.cn/",r="",u={token:r,serverSrc:n,serverChat:o,requestFail:function(t){0===t.statusCode?e.showToast({title:"未知的网络错误, 请确保设备处在联网状态",icon:"none"}):e.showToast({title:"发生网络错误，错误码为："+t.statusCode,icon:"none"})},tokenFail:function(){e.showToast({title:"身份验证失效，请重新登录！",icon:"none"}),e.redirectTo({url:"/pages/common/login"})},checkUpdater:function(t,o){e.request({url:n+"common/check_update/update",method:"GET",success:function(n){200===n.statusCode&&t!=n.data.version&&e.showModal({title:"发现新版本",content:"有新版本可用，请问您是否更新？",success:function(t){t.confirm&&e.navigateTo({url:o})}})}})}};t.default=u}).call(this,o("649d")["default"])},e233:function(e,t,o){"use strict";o.r(t);var n=o("799b"),r=o("a08b");for(var u in r)"default"!==u&&function(e){o.d(t,e,function(){return r[e]})}(u);var s=o("2877"),a=Object(s["a"])(r["default"],n["a"],n["b"],!1,null,null,null);t["default"]=a.exports},e6b7:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o("2f62");function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){u(e,t,o[t])})}return e}function u(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var s={computed:(0,n.mapState)(["msg"]),methods:r({},(0,n.mapMutations)(["appOnLunch","addMsg"])),onLaunch:function(){var t=new Object;if(t.user=e.getStorageSync("user"),!0===t.user.hasLogin){t.school=e.getStorageSync("school"),t.selectSchool=e.getStorageSync("selectSchool"),this.appOnLunch(t),e.connectSocket({url:this.GLOBAL.serverChat});var o=this;e.onSocketOpen(function(n){console.log("WebSocket连接已打开！");var r={ctype:"init",id:t.user.id};e.sendSocketMessage({data:JSON.stringify(r)}),e.onSocketMessage(function(e){var t=JSON.parse(e.data);console.log(JSON.stringify(t));var n={toId:t.id,img:t.face,title:t.name,desc:t.msg,status:"未读"};o.addMsg(n)})})}var n=e.getStorageSync("updated");!0===n.completed&&e.removeSavedFile({filePath:n.packgePath,success:function(t){e.removeStorageSync("updated")}}),this.GLOBAL.checkUpdater(plus.runtime.version,"../common/update")},onShow:function(){e.showModal({title:"提示",content:"此版本为源梦团队内部测试版本，未经允许禁止发布到互联网！www.ym998.cn",showCancel:!1})},onHide:function(){console.log("App Hide")}};t.default=s}).call(this,o("649d")["default"])},ed8f:function(e,t,o){"use strict";o.r(t);var n=o("3c04");for(var r in n)"default"!==r&&function(e){o.d(t,e,function(){return n[e]})}(r);o("8d42");var u,s,a=o("2877"),c=Object(a["a"])(n["default"],u,s,!1,null,null,null);t["default"]=c.exports}},[["2c83","common/runtime","common/vendor"]]]);